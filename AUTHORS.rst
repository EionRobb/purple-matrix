Richard van der Hoff <richard at matrix.org>
 * Original implementation

Eion Robb <eion at robbmob.com>
 * Windows build
 * Fix online/offline switch

